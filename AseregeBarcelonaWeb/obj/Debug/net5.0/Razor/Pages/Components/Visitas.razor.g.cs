#pragma checksum "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "c6a058464bf116c21eac0a182b425fa2ab5e44e9"
// <auto-generated/>
#pragma warning disable 1591
namespace AseregeBarcelonaWeb.Pages.Components
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using MudBlazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Shared.Dialogs;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Pages.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Model.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Manager;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using AseregeBarcelonaWeb.Manager.Enums;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\_Imports.razor"
using BlazorMultiavatar;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
using System.IO;

#line default
#line hidden
#nullable disable
    public partial class Visitas : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, @"<h3>Visitas</h3>

<iframe src=""https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d79965.21656046658!2d2.07023247507779!3d41.39017125657571!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x12a49816718e30e5%3A0x44b0fb3d4f47660a!2sBarcelona!5e0!3m2!1ses!2ses!4v1681565921119!5m2!1ses!2ses"" width=""600"" height=""450"" style=""border:0;"" allowfullscreen loading=""lazy"" referrerpolicy=""no-referrer-when-downgrade""></iframe>
");
            __builder.OpenElement(1, "img");
            __builder.AddAttribute(2, "src", 
#nullable restore
#line 5 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
           PictureImage

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(3, "\n");
            __builder.OpenComponent<global::MudBlazor.MudPaper>(4);
            __builder.AddAttribute(5, "Class", "pa-2 pt-2 mt-4");
            __builder.AddAttribute(6, "Elevation", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::System.Int32>(
#nullable restore
#line 6 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
                                            3

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(7, "ChildContent", (global::Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.OpenElement(8, "iframe");
                __builder2.AddAttribute(9, "src", 
#nullable restore
#line 6 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
                                                             VideoUrl

#line default
#line hidden
#nullable disable
                );
                __builder2.CloseElement();
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(10, "\n\n");
            __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.InputFile>(11);
            __builder.AddAttribute(12, "OnChange", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::Microsoft.AspNetCore.Components.EventCallback<global::Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>>(global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>(this, 
#nullable restore
#line 8 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
                     HandleSeleccionArchivo

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(13, "multiple", true);
            __builder.CloseComponent();
        }
        #pragma warning restore 1998
#nullable restore
#line 11 "C:\Users\Edgar Muñoz\source\repos\AseregeHTMLFramework-Razor_Branch\AseregeBarcelonaWeb\Pages\Components\Visitas.razor"
 
    public string VideoUrl { get; set; } = "https://www.youtube.com/embed/u5-kia2bzpQ";
    private Picture PictureImage { get; set; }
    protected override async Task OnInitializedAsync()
    {
        using (Manager.MySQLManager manager = new Manager.MySQLManager())
        {
            PictureImage = await manager.SelectPicturesByIDAsync(3);
        };
        await Task.CompletedTask;
    }
    //Esta función almacena los archivos y lo guarda en un MemoryStream. Luego, accede a la primera posición y escribe los bytes a partir de esa posición
    //Crea una instancia a la base de datos y guardo el hash del archivo. Una vez acabado, saltará a la instrucción Task.CompletedTask; 
    // para comprobar que se ha acabado la tarea    
    private async Task HandleSeleccionArchivo(InputFileChangeEventArgs e)
    {        
        foreach (IBrowserFile file in e.GetMultipleFiles())
        {
            if (file.ContentType.StartsWith("image/"))
            {
                using (Manager.MySQLManager manager = new Manager.MySQLManager())
                {       
                    using (MemoryStream ms = new MemoryStream())
                    {                        
                        ms.Position = 0;                    
                        await file.OpenReadStream(8388608, default).CopyToAsync(ms);


                        ms.Position = 0;               
                        DateTime Date = DateTime.Now;
                        //escribir en la base de datos el stream procesado en la RAM                        
                        
                        Picture picture = new Picture()
                        {                                                                
                            Name = Manager.CryptographyManager.GenerateHash(Date.ToString(), file.Name),
                            Format = file.ContentType,
                            Date = file.LastModified.ToLocalTime().DateTime,
                                Data = Convert.ToBase64String(ms.ToArray()),
                            Authorize = new Authorize()
                            {
                                Name = await jsRuntime.InvokeAsync<string>("localStorage.getItem", "Name"),
                                Password = await jsRuntime.InvokeAsync<string>("localStorage.getItem", "Password")
                            }
                        };
                        await manager.InsertFile(picture);
                        await Task.CompletedTask;
                    }
                }                                
            }
        }
    }    

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IDialogService DialogService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ISnackbar SnackbarService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime jsRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager Navigation { get; set; }
    }
}
#pragma warning restore 1591
